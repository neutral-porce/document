webpackJsonp([12],{140:function(e,t,n){function a(e,t){return e=[].concat(e)[0],e&&location.protocol+'//'+location.host+'/coremail/s?func=lp:getImg&org_id='+r+'&img_id='+e+(t?'&hash='+Math.random():'')}window.I18N_CONST=window.I18N_CONST||{},window.SYS_CONST=window.SYS_CONST||{};var o=(window.CUSTOME_DATA||{}).indexPageData2||{},r=o.org||'',i=o.real_resource||{},c=i.facade_custom||{},s=n(1),l=c.copyright_text;l&&(c.copyright_text=s('<div>').text(c.copyright_text.replace(/&copy;/g,'Â©')).html()),e.exports={customized:!s.isEmptyObject(o),DATA:s.extend(!0,{},i,{orgId:r,facade_custom:c}),facadeCustom:c,lpImg:a,logoUrl:a.bind(null,c.logo),backgroundUrl:a.bind(null,c.background),favorUrl:a.bind(null,c.favor,!0),faceSetting:window.SYS_CONST.faceSetting}},193:function(e,t,n){var a=n(20),o={or:function(e,t,n){return e||t?n.fn(this):n.inverse(this)},customLpImg:function(e,t){return n(140).lpImg(e)||t},isArrayNotNull:function(e,t){return'object'==typeof e&&0!==e.length?t.fn(this):t.inverse(this)}};for(var r in o)o.hasOwnProperty(r)&&a.registerHelper(r,o[r]);e.exports=a},292:function(e,t,n){var a=n(140);!function(){var t=n(1),o=n(77),r={face:'face'},i={expires:30,path:'/'},c=function(e){e.customRadioCheckbox()},s=function(){function e(e){var a='';a+=n('label.slogan',{'color':e.facade_custom.slogan_color,'font-size':e.facade_custom.slogan_fontsize?e.facade_custom.slogan_fontsize+'px':''}),a+=n('button.u-btn',{'background-color':e.facade_custom.submit_button_color,'color':e.facade_custom.submit_button_font_color}),t('#dHead').append(t('<style type="text/css">'+a+'</style>'))}function n(e,n){var a='';return t.isEmptyObject(n)?a:(a+=e+'{',t.each(n,function(e,t){t&&(a+=e+':'+t+';')}),a+='}')}function c(e){if(e.facade_custom.favor_title&&(document.title=e.facade_custom.favor_title),l){var t=document.createElement('link');t.type='image/x-icon',t.rel='shortcut icon',t.href=l,document.getElementsByTagName('head')[0].appendChild(t)}}var s=a.DATA,l=a.favorUrl();a.customized&&(e(s),c(s)),o.set(r.face,a.faceSetting||'XT5',i),/MSIE ([67])/i.test(navigator.userAgent)||setTimeout(function(){t('.aside-blur').blurjs({source:'.main-bottom',radius:5,cacheExpired:3e4,cache:!1})},500)};t.fn.blurjs=function(e){function a(e,a,o,r,i,c){var s=t.Deferred(),l=n(830)();if(!(isNaN(c)||c<1)){c|=0;var u,d=e.getContext('2d');try{try{u=d.getImageData(a,o,r,i)}catch(h){try{netscape.security.PrivilegeManager.enablePrivilege('UniversalBrowserRead'),u=d.getImageData(a,o,r,i)}catch(h){throw alert('Cannot access local image'),new Error('unable to access local image data: '+h)}}}catch(h){throw alert('Cannot access image'),new Error('unable to access image data: '+h)}return l.onmessage=function(e){var t=e.data;if('afterCal'===t.type)return d.putImageData(t.j,a,o),s.resolve()},l.postMessage({type:'cal',d:r,j:u,g:c,f:i}),s.promise()}}e.cacheExpired=e.cacheExpired||Number.MAX_VALUE;var o=(new Date).getTime(),r=document.createElement('canvas'),i=!1,c=t(this).selector.replace(/[^a-zA-Z0-9]/g,'');if(r.getContext&&'Worker'in window)return e=t.extend({source:'body',radius:5,overlay:'',offset:{x:0,y:0},optClass:'',cache:!1,cacheKeyPrefix:'blurjs-',draggable:!1,debug:!1},e),this.each(function(){var n,s=t(this),l=t(e.source),u=l.css('backgroundImage').replace(/"/g,'').replace(/url\(|\)$/gi,''),d=r.getContext('2d'),h=new Image;h.onload=function(){function t(t){var n=l.css('backgroundAttachment'),a='fixed'===n?'':'-'+(s.offset().left-l.offset().left-e.offset.x)+'px -'+(s.offset().top-l.offset().top-e.offset.y)+'px';s.css({'background-image':'url("'+t+'")','background-repeat':l.css('backgroundRepeat'),'background-position':a,'background-attachment':n}),e.optClass!==!1&&s.addClass(e.optClass),e.draggable&&(s.css({'background-attachment':'fixed','background-position':'0 0'}),s.draggable())}i?t(h.src):(r.style.display='none',r.width=h.width,r.height=h.height,d.drawImage(h,0,0),a(r,0,0,r.width,r.height,e.radius).then(function(){e.overlay&&(d.beginPath(),d.rect(0,0,h.width,h.width),d.fillStyle=e.overlay,d.fill());var a=r.toDataURL();if(e.cache)try{e.debug&&console.log('Cache Set'),localStorage.setItem(e.cacheKeyPrefix+c+'-'+u+'-data-image',a),n=localStorage.setItem(e.cacheKeyPrefix+c+'-'+u+'-data-image-cacheAt',o)}catch(i){console.log(i)}t(a)}))},Storage.prototype.cacheChecksum=function(t){var n='';for(var a in t){var o=t[a];n+='[object Object]'===o.toString()?(o.x.toString()+o.y.toString()+',').replace(/[^a-zA-Z0-9]/g,''):(o+',').replace(/[^a-zA-Z0-9]/g,'')}var r=this.getItem(e.cacheKeyPrefix+c+'-'+u+'-options-cache');r!==n&&(this.removeItem(e.cacheKeyPrefix+c+'-'+u+'-options-cache'),this.setItem(e.cacheKeyPrefix+c+'-'+u+'-options-cache',n),e.debug&&console.log('Settings Changed, Cache Emptied'))};var f=null;if(e.cache){localStorage.cacheChecksum(e),n=localStorage.getItem(e.cacheKeyPrefix+c+'-'+u+'-data-image-cacheAt');var g=parseInt(o)-parseInt(n);g>0&&g<e.cacheExpired&&(f=localStorage.getItem(e.cacheKeyPrefix+c+'-'+u+'-data-image'))}null!=f?(e.debug&&console.log('Cache Used'),i=!0,h.src=f):(e.debug&&console.log('Source Used'),h.src=u)})},/*!
	         * jQuery Custom Radio Checkbox Plugin
	         * Copyright (c) 2012-2014 Denis Ciccale (@tdecs)
	         * Released under MIT license (https://raw.github.com/dciccale/Custom-radio-checkbox/master/LICENSE.txt)
	         */
t.fn.customRadioCheckbox=function(){if(this[0]){var e='-checked',n='rc-hidden',a='rc-disabled',o=function(){var e=t(this);e.closest('label')[0]||e.prev().trigger('change.crc',[!0])},r=function(n){for(var r,i,c,s=n.type,l=n.length;l--;)c=n[l],r=t(c).prop('disabled'),i=t('<i>').addClass(s+(c.checked?' '+s+e:'')),i.bind('click.crc',o),r&&i.addClass(a),c.parentNode.insertBefore(i[0],c.nextSibling)};return this.each(function(){var a,o=t(this),i=o.find('input[type=radio]:not(.'+n+')').addClass(n),c=o.find('input[type=checkbox]:not(.'+n+')').addClass(n),s={},l=i.length;if(i.length){for(i.type='radio',r(i);l--;)a=i[l],a.checked&&((s[a.name]={}).checked=t(a.nextSibling));i.bind('change.crc',function(n,a){return!t(this).prop('disabled')&&(a&&this.checked||(s[this.name]||(s[this.name]={}),s[this.name].checked&&s[this.name].checked.removeClass(i.type+e),s[this.name].checked=t(this.nextSibling).addClass(i.type+e)),void(a&&!this.checked&&(this.checked=!0)))})}c.length&&(c.type='checkbox',r(c),c.bind('change.crc',function(n,a){return!t(this).prop('disabled')&&(a&&(this.checked=!this.checked),void t(this.nextSibling).toggleClass(c.type+e))}))})}},e.exports={customRadioCheckbox:c,blurBgImg:s}}()},293:function(e,t,n){var a;a=function(e){function t(e){function t(e){return'string'==typeof e&&e.length?('"'===e[0]&&'"'===e[e.length-1]&&(e=e.slice(1,-1)),e):e}var n,a,o,r=f;return(n=d.get(r.token+encodeURI(e)))?(n=t(n),h?(a=t(d.get(r.secret+encodeURI(e))||''),o=t(d.get(r.nonce+encodeURI(e))||'')):(d.remove(r.secret+encodeURI(e),{path:'/'}),d.remove(r.nonce+encodeURI(e),{path:'/'}),a=!1,o=!1),{token:n,secret:a,nonce:o}):null}function a(e,t){var n,a,o,r,i='Coremail.auth.'+e;if(!h)return null;var c=localStorage.getItem(i);return null==c?null:(c=s.parseJSON(c),n=c['token'],a=c['secret'],o=c['nonce'],r=Math.ceil(c['expires']/1e3),!isNaN(r)&&t&&r<t?(localStorage.removeItem(i),null):{token:n,secret:a,nonce:o})}function o(e){var n,o,r,i,c,s=Math.ceil((new Date).getTime()/1e3),l=a(e,s)||t(e);return null==l?null:(n=l.token,o=l.secret,r=l.nonce,n&&o&&r?(c=new u('SHA-1','TEXT',{numRounds:1}),c.update('accessToken='+encodeURIComponent(n)+'&nonce='+encodeURIComponent(r)+'&timestamp='+encodeURIComponent(s)+'&secret='+encodeURIComponent(o)),i=c.getHash('B64')):i=!1,{token:n,secret:o,nonce:r,signature:i,timestamp:s})}function r(e){if(!e)return null;var t=o(e);return null!=t&&t.token?t:null}function i(){var e,t=l.device,n=l.os,a=l.browser,o='na',r='';a.name===o?e=o:(e=a.name,'-1'!==a.version&&(e+=' '+a.version)),r=t.name===o||'pc'===t.name?n.name:t.name;var i={uuid:'webmail_'+r,imie:'webmail_'+r,friendlyName:e,model:r,os:n.name,osLanguage:navigator.language,deviceType:'Webmail'};return i}function c(){return i()}var s=n(1),l=n(105),u=n(283),d=n(77),h=function(){var e='cm.ls.test';try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(t){return!1}}(),f={token:'Coremail.token.',secret:'Coremail.secret.',nonce:'Coremail.nonce.'};return{supportLocalStorage:h,formatLoginToken:r,formatLoginDeviceInfo:c}}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},294:function(e,t,n){var a;a=function(e){var t=n(1),a=n(193),o=n(139),r=n(194);n(195);var i='f-dn',c='disabled',s=null,l=null,u=null,d=null,h=null,f=null,g=null,m=function(e){e='boolean'==typeof e&&e,e?(u.addClass(i),l.removeClass(i)):(l.addClass(i),u.removeClass(i))},p=function(e,n){return!(!e||!e.length)&&(n=t.isFunction(n)?n:t.noop,e.off('focus').on('focus',function(){t(this).off('keyup.enter').on('keyup.enter',function(e){13===e.keyCode&&n(e)})}).off('blur').on('blur',function(){t(this).off('keyup.enter')}),void setTimeout(function(){e.trigger('focus')},200))},v=function(e){var n=d.find('.j-code'),o=d.find('.j-wrap'),r=o.find('.j-error'),i=t.trim(n.val()).toUpperCase();return i.length?i:(r.length>0&&r.remove(),o.append(a.compile(t('#errorMsgTpl').html())({errorMsg:e})),n.focus(),'')},b=function(){return!(!f||!f.length)&&void f.trigger('click')},y=function(e){this.authData=e.authData,this._render(),this._initEvents()};y.prototype={constructor:y,submit:function(){var e=v(this.authData.emptySMSCodeMsg);e.length>0&&(u.find('#verifyCellCode').val(e),g.trigger('click'))},cancel:function(){this._offEvents()},_render:function(){d.html(a.compile(t('#smsVerifyTpl').html())(this.authData)),p(d.find('.j-code'),b)},_initEvents:function(){d.off('click','.j-send').on('click','.j-send',t.proxy(this._handleSendCode,this))},_offEvents:function(){d.off('click','.j-send')},_handleSendCode:function(){u.find('#resendCellCode').prop('disabled',!1),g.trigger('click')}};var S=function(e){this.authData=e.authData,this._render()};S.prototype={constructor:S,submit:function(){var e=v(this.authData.emptyDynamicPasswordMsg);e.length>0&&(u.find('.j-form-dynamicPwd').val(e),g.trigger('click'))},cancel:function(){},_render:function(){d.html(a.compile(t('#dynamic1VerifyTpl').html())(this.authData)),p(d.find('.j-code'),b)}};var k=function(e){this.authData=e.authData,this.authType=this.authEnums.PUSH,this.$verifyWrap=null,this.observer=null,this._render()};k.prototype={constructor:k,authEnums:{PUSH:1,CODE:2},submit:function(){var e='';this.authType===this.authEnums.PUSH?this._doSubmit(e):(e=v(this.authData.emptyAuthCodeMsg),e.length>0&&this._doSubmit(e))},cancel:function(){this._unSubscribe()},_unSubscribe:function(){null!=this.observer&&this.observer.unSubscribe()},_doSubmit:function(e){null!=this.observer&&this.observer.unSubscribe(),u.find('.j-form-dynamicPwd').val(e),g.trigger('click')},_render:function(){d.html(a.compile(t('#dynamic2VerifyWrapTpl').html())()),this.$verifyWrap=d.find('.j-dynamic2-verify'),this.authType===this.authEnums.CODE?this._renderCode():this._renderPush(),this._prepareValidate()},_renderPush:function(){var e=this;this.authType=this.authEnums.PUSH,f.addClass(c).addClass(i),this.$verifyWrap.html(a.compile(t('#dynamic2PushVerifyTpl').html())(this.authData)),this.$verifyWrap.off('click','.j-toggle').on('click','.j-toggle',function(){e._renderCode()})},_renderCode:function(){var e=this;this.authType=this.authEnums.code,f.removeClass(c).removeClass(i),this.$verifyWrap.html(a.compile(t('#dynamic2CodeVerifyTpl').html())(this.authData)),p(d.find('.j-code'),b),this.$verifyWrap.off('click','.j-toggle').on('click','.j-toggle',function(){e._renderPush()})},_prepareValidate:function(){var e=this,n=this.authData;t.ajax({type:'POST',url:'/coremail/s/json?func=user:triggerSecondAuth',data:'{"trans": "login", "tempSid": "'+n.tempSession+'"}',headers:{Accept:'text/x-json'},contentType:'text/x-json'}).done(function(t){t&&t.code&&'S_OK'!==t.code||e._subscribeValidate()}).fail(function(){})},_subscribeValidate:function(){var e=this,n=WsStore.topics.OTP_AUTH,a=this.authData;'WebSocket'in window?(n=n.replace('$uid$',a.uid),n=n.replace('$tempsid$',a.tempSession),WsStore.subscribe(n,function(n){var o=n.payload.trans;return'login'!==o?(alert('invalid trans'),!1):(WsStore.unSubscribe(),void t.ajax({type:'POST',url:'/coremail/s/json?func=user:querySecondAuthValidateStage',data:'{"trans": "login", "tempSid": "'+a.tempSession+'"}',headers:{Accept:'text/x-json'},contentType:'text/x-json'}).done(function(t){e._unSubscribe();var n=t&&t.code;return'S_OK'===n?void(t['var']&&'VALIDATED'===t['var']['stage']&&(f.removeClass(c).removeClass(i),f.trigger('click'))):void('FA_INVALID_TEMP_SESSION'===n&&(a.forceCode=!0,e._renderCode()))}).fail(function(){e._unSubscribe()}))},{authMeta:{clientId:'webmail:'+a.tempSession,sid:a.tempSession,TmpSes:1},io:o,host:e.authData.host}),this.observer=WsStore):this.observer=new r({topic:'/coremail/s/json?func=user:querySecondAuthValidateStage',data:'{"trans": "login", "tempSid": "'+a.tempSession+'"}',successCallback:function(t){t.stage&&'VALIDATED'===t.stage&&(e._unSubscribe(),f.removeClass(c).removeClass(i),f.trigger('click'))},errorCallback:function(t){'FA_INVALID_SESSION'!==t.code&&'FA_INVALID_TEMP_SESSION'!==t.code||e._unSubscribe()}}).subscribe()}};var C=function(e){var n,a;return!t.isEmptyObject(e)&&(a=e.backObserver||t.noop,s=e.authData,l=e.$authWrap,u=e.$loginForm,d=l.find('.j-auth-body'),h=l.find('.j-auth-footer'),f=h.find('.j-confirm'),g=u.find('.j-submit'),s.dynamic1?n=new S({authData:s}):s.dynamic2?n=new k({authData:s}):s.sms&&(n=new y({authData:s})),m(!0),h.off('click','.j-confirm').on('click','.j-confirm',function(){var a;if(e.authData.needVerifyCode){if(a=t.trim(l.find('.j-vc-verify-code').val()),!a.length)return void alert(e.authData.emptyVerifyCodeMsg);u.find('.j-vc-verify-code').val(a.toUpperCase())}var o,r=h.find('.j-authorize-device');r.length&&(o=r.prop('checked'),o&&u.find('.j-authorizeDevice').val(!0)),n.submit()}),h.off('click','.j-back').on('click','.j-back',function(e){a()!==!1&&(n.cancel(),m(!1))}),void h.off('click','.j-back-to-referrer').on('click','.j-back-to-referrer',function(){n.cancel();var e=u.find('.j-startReferrer');if(e.length&&e.val().length)location.replace(e.val());else{if(a()===!1)return;m(!1)}}))};return{initVerify:C}}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},830:function(e,t,n){e.exports=function(){return new Worker(n.p+'0065b3b65b579c817d46.worker.js')}}});
//# sourceMappingURL=common-login.a48e1.js.map